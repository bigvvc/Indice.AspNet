<swal title="Delete?" text="User will be deleted permanently. This action cannot be reversed." type="warning" [showCancelButton]="true" (confirm)="delete()" #deleteAlert></swal>
<p *ngIf="!user">Loading user data...</p>
<form class="needs-validation" *ngIf="user" [ngClass]="{ 'was-validated': form.submitted }" (ngSubmit)="form.form.valid && update()" novalidate #form="ngForm">
    <div class="form-group row">
        <label for="user-name" class="col-sm-2 col-form-label">Username (*)</label>
        <div class="col-sm-10">
            <input class="form-control" type="text" id="user-name" name="user-name" [(ngModel)]="user.userName" maxlength="256" required #userName="ngModel" />
            <div *ngIf="form.submitted && userName.invalid" class="form-control-feedback text-danger">Field 'Username' is required.</div>
        </div>
    </div>
    <div class="form-group row">
        <label for="user-email" class="col-sm-2 col-form-label">Email (*)</label>
        <div class="col-sm-10">
            <input class="form-control" type="text" id="user-email" name="user-email" [(ngModel)]="user.email" maxlength="256" required email #email="ngModel" />
            <div *ngIf="form.submitted && email.invalid && email.errors['required']" class="form-control-feedback text-danger">Field 'Email' is required.</div>
            <div *ngIf="form.submitted && email.invalid && email.errors['email']" class="form-control-feedback text-danger">Please enter a valid email address.</div>
        </div>
    </div>
    <div class="form-group row">
        <label for="user-email-confirmed" class="col-sm-2 col-form-label">Email Confirmed</label>
        <div class="col-sm-10">
            <div class="form-check col-form-label">
                <input class="form-check-input" type="checkbox" id="user-email-confirmed" name="user-email-confirmed" [checked]="user.emailConfirmed" disabled />
            </div>
        </div>
    </div>
    <div class="form-group row">
        <label for="user-create-date" class="col-sm-2 col-form-label">Create Date</label>
        <div class="col-sm-10 col-form-label">
            <span class="col-form-label" id="user-create-date" name="user-create-date">{{ user.createDate | date:'medium' }}</span>
        </div>
    </div>
    <div class="form-group row">
        <label for="user-phone-number" class="col-sm-2 col-form-label">Phone Number</label>
        <div class="col-sm-10">
            <input class="form-control" type="tel" id="user-phone-number" name="user-phone-number" [(ngModel)]="user.phoneNumber" />
        </div>
    </div>
    <div class="form-group row">
        <label for="user-phone-number-confirmed" class="col-sm-2 col-form-label">Phone Number Confirmed</label>
        <div class="col-sm-10">
            <div class="form-check col-form-label">
                <input class="form-check-input" type="checkbox" id="user-phone-number-confirmed" name="user-phone-number-confirmed" [checked]="user.phoneNumberConfirmed" disabled />
            </div>
        </div>
    </div>
    <div class="form-group row" *ngFor="let claim of requiredClaims; let i = index">
        <label [for]="'user-' + claim.name" class="col-sm-2 col-form-label">{{ claim.displayName || claim.name }} (*)</label>
        <div class="col-sm-10">
            <app-dynamic-input [id]="'user-' + claim.name" [name]="'user-' + claim.name" [pattern]="claim.rule" [(ngModel)]="requiredClaims[i].value" [modelType]="claim.valueType" 
                required #input="ngModel">
            </app-dynamic-input>
            <div *ngIf="form.submitted && input.invalid && input.errors['required']" class="form-control-feedback text-danger">Field '{{ claim.displayName || claim.name }}' is required.</div>
            <div *ngIf="form.submitted && input.invalid && input.errors['pattern']" class="form-control-feedback text-danger">Pattern not correct.</div>
        </div>
    </div>
    <div class="form-group">
        <div>
            <button type="submit" class="btn btn-primary waves-effect waves-light m-r-5">Update</button>
            <button type="button" class="btn btn-danger waves-effect m-r-5 float-right" (click)="deletePrompt()">Delete</button>
        </div>
    </div>
</form>
